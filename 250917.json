[
  {
    "bookSourceComment": "åŸºäº PyFQWeb é¡¹ç›®å¼€å‘çš„ Legado å…¼å®¹ä¹¦æº\n/*\næœç´¢æ¨¡å¼é»˜è®¤æ˜¯æœä¹¦\néœ€è¦æ¼«ç”»åˆ™åœ¨å…³é”®å­—å‰åŠ m:å³m:ç³»ç»Ÿ\nå¬ä¹¦åˆ™ä¸ºt:ç³»ç»Ÿ \nçŸ­å‰§åˆ™ä¸ºd:ç³»ç»Ÿ\n*/",
    "bookSourceName": "ğŸ… ç•ªèŒ„2.0",
    "bookSourceType": 0,
    "bookSourceUrl": "æ•´åˆä¹¦æºæ¥æºè€…:Buding\nå‘ç°é¡µæä¾›æ¥æº:é˜¿é¹\nä¹¦æºæ¥å£æä¾›è€…:åå®‰\nä¹¦æºç»´æŠ¤ä¿®å¤è€…:æ¸…è¯\næœ¬ä¹¦æºæ”¯æŒåŠŸèƒ½:\n1.ç•ªèŒ„å°è¯´ï¼Œç•ªèŒ„å¬ä¹¦ï¼Œç•ªèŒ„æ¼«ç”»ï¼Œç•ªèŒ„çŸ­å‰§\n2.æ”¯æŒåˆ©ç”¨ä¹¦ç±IDæœå°é»‘å±‹ä¹¦ç±ï¼\nä¹¦æºç‰¹åˆ«è¯´æ˜è¯:\n1.ç¦æ­¢ä¸‹è½½ï¼Œå¦åˆ™ä¸€äººä¸‹è½½å…¨å‘˜é­æ®ƒï¼\n2.é¢„ä¸‹è½½è°ƒä¸ªå››äº”ç« ä¹Ÿå¯ä»¥ï¼Œåªè¦ä¸é«˜é€Ÿè¯·æ±‚ï¼Œä¸ä¸‹è½½ç†è®ºå°è¯´å’Œæ¼«ç”»æ­£æ–‡ä¸ä¼šæœ‰é—®é¢˜ï¼\n(å“ªæ€•ä½ ä¸‹è½½ï¼Œå¬ä¹¦å’ŒçŸ­å‰§ä¾ç„¶èƒ½ç”¨ï¼)\n3.å¦‚æœå¿ä¸ä½ï¼Œæœ€å¥½é¢„ä¸‹è½½è°ƒä¸ªå››äº”ç« ä¹Ÿå¯ä»¥ï¼Œåªè¦ä¸é«˜é€Ÿè¯·æ±‚ï¼",
    "bookUrlPattern": "https?://.*(fqnovel|snssdk|fanqienovel|changdunovel|sukimon|ttdndd|qkg1)\\.(top|com|me).*[0-9]{19}.*",
    "customOrder": -2,
    "enabled": true,
    "enabledCookieJar": true,
    "enabledExplore": true,
    "exploreUrl": "@js:\nä¸ªäººä¸­å¿ƒ = 1\n\njs = (cid, genre, gender) => `@js:\ngetApi() + \"/reading/bookapi/new_category/landing/v/?\" + [\n    \"category_id=${cid}\",\n    \"limit=20\",\n    \"offset=\" + (page - 1),\n    \"gender=${gender}\",\n    \"genre=${genre}\"\n  ].join(\"&\")`\n\nobj = (title, url, type) => ({\n  title: title,\n  url: url,\n  style: {\n    layout_flexGrow: 1,\n    layout_flexBasisPercent: type\n  }\n})\n\narr = []\njava.longToast(\"è¯·ç¨ç­‰ï¼Œå‘ç°åˆ—è¡¨æ­£åœ¨çƒ­æ›´æ–°ï¼\")\nindex=[0, 1, 2]\nfor (let i of index) {\n  // java.toast(i)\n  let type = i\n  $ = JSON.parse(java.ajax(getApi() + \"/reading/bookapi/new_category/front/v/?\" + [\n      \"update_version_code=58932\",\n      \"distinct_style=1\",\n      \"new_category_tab=\" + i\n    ].join(\"&\")\n  )).data.category_tab_data\n  cate = []\n  cate.push(obj(\n    \"====== \" + $.tab_name + \" ======\", \"\", 1\n  ))\n  $.cell_data.forEach((c) => {\n    gender_1 = (type == 0 || type == 1) ? 2 : 1;\n    genre_1 = type == 2 ? 2 : type == 3 ? 1 : type == 5 ? 110 : type == 6 ? 130 : 0;\n    cate.push(obj(\n      c.cell_name,\n      js(c.atom_data[0].category_data.category_id, genre_1, gender_1),\n      1\n    ))\n    for (j = 2; j < 5; j++) {\n      c.atom_data.slice(1).forEach((a) => {\n        d = a.category_data\n        if (d.name.length == j) {\n          cate.push(obj(d.name, js(d.category_id, genre_1, gender_1), -1))\n        }\n      })\n    }\n  })\n  arr = cate.concat(arr)\n}\n\nlet book_shelf_url = 'https://fanqienovel.com/reading/bookapi/bookshelf/info/v:version/?aid=1967&iid=0&version_code=57700&update_version_code=57700' \nlet book_shelf_info = JSON.parse(java.ajax(book_shelf_url + ', ' + JSON.stringify({\n  headers: {\n    'Cookie': \"sessionid=\" + (String(cookie.getKey(\"fanqienovel.com\", \"sessionid\")) ? String(cookie.getKey(\"fanqienovel.com\", \"sessionid\")) : (source.getLoginInfoMap() ? source.getLoginInfoMap() : {})['æ‰‹åŠ¨ç™»å½•Token']),\n  }\n})))\n\njava.log(JSON.stringify(book_shelf_info))\n\nlet username\nif (book_shelf_info.code != 0) {\n  ä¸ªäººä¸­å¿ƒ = 0\n} else {\n  let uinfo = java.ajax(\"https://fanqienovel.com/api/user/info/v2,\" + JSON.stringify({ headers: { Cookie: \"sessionid=\" + (String(cookie.getKey(\"fanqienovel.com\", \"sessionid\")) ? String(cookie.getKey(\"fanqienovel.com\", \"sessionid\")) : (source.getLoginInfoMap() ? source.getLoginInfoMap() : {})['æ‰‹åŠ¨ç™»å½•Token']) }}))\n  uinfo = JSON.parse(uinfo)\n  username = uinfo.data.name\n}\n\nlet gro = []\npush = (title, url, type) => gro.push({\n  title: title,\n  url: url,\n  style: {\n    layout_flexGrow: 1,\n    layout_flexBasisPercent: type\n  }\n});\n\nlet sArr = []\n\nif (ä¸ªäººä¸­å¿ƒ) {\n  let groups_bookids = {\n    \"æœªåˆ†ç»„\": []\n  }\n  book_shelf_info.data.book_shelf_info.forEach(i => {\n    if (!groups_bookids[i.group_name ? i.group_name : \"æœªåˆ†ç»„\"]) groups_bookids[i.group_name] = []\n    groups_bookids[i.group_name ? i.group_name : \"æœªåˆ†ç»„\"].push(i.book_id)\n  })\n\n  Object.keys(groups_bookids).forEach(k => {\n    var multi_detail_post_body = {\n      data: {\n        book_shelf_info: []\n      }\n    }\n    groups_bookids[k].forEach(i => multi_detail_post_body.data.book_shelf_info.push({ book_id: String(i), item_id: '0' }))\n    // var multi_detail_group_url = `https://fanqienovel.com/api/bookshelf/multidetail,${JSON.stringify(multi_detail_post_body)}` \n    // var book_ids = getBookId(JSON.stringify(multi_detail_post_body)).join(\",\") \n    push(k, \"https://fanqienovel.com/fqbookshelf/groupName/\" + k, 0.4)\n  })\n  if (Object.keys(groups_bookids).length % 2 != 0) push(\"å ä½\", \"\", 0.4)\n  // java.log(JSON.stringify(gro, null, 2))\n  sArr.push(obj(username + 'çš„ä¸ªäººä¸­å¿ƒ', '', 1))\n  // sArr.push(obj('é¦–é¡µæ¨è', \"https://fanqienovel.com/tab/0\", 0.4))\n  // sArr.push(obj('çŒœä½ å–œæ¬¢', \"https://fanqienovel.com/tab/1\", 0.4))\n  // sArr.push(obj('çŒœä½ å–œæ¬¢', \"https://fanqienovel.com/tab/1\", 0.4))\n  sArr.push(obj(\"æˆ‘çš„ä¹¦æ¶\", \"https://fanqienovel.com/fqbookshelf\", 1))\n  \n  sArr = sArr.concat(gro)\n  // java.toast(JSON.stringify(sArr)) \n  sArr.push(obj(\"é˜…è¯»å†å²\",\"https://fanqienovel.com/reading/bookapi/read_history/list/v/?aid=1967&app_name=novelapp&channel=0&iid=1&offset={{(page-1)*100}}&os_version=12&version_code=59732,\" + JSON.stringify({ headers: { Cookie: \"sessionid=\" + (String(cookie.getKey(\"fanqienovel.com\", \"sessionid\")) ? String(cookie.getKey(\"fanqienovel.com\", \"sessionid\")) : (source.getLoginInfoMap() ? source.getLoginInfoMap() : {})['æ‰‹åŠ¨ç™»å½•Token']) }}), 1))\n}\n\narr = sArr.concat(arr)\nJSON.stringify(arr)\n",
    "jsLib": "\n\n\n  function getHost() {\r\n    const { java, source, book } = this;\r\n    let loginInfoMap = source.getLoginInfoMap();\n    let apikey = \"https://fq.xo0x.cn\"; \r\n    if (loginInfoMap && loginInfoMap['åŸŸå'] && loginInfoMap['åŸŸå'] !== \"\" &&  loginInfoMap['åŸŸå'].includes('0')) {\r\n        apikey = loginInfoMap['åŸŸå'];\r\n \r\n    }\r\n    return apikey;\r\n}\n\n\n\n\nlet replaceCover = (u) => {\n    if (u.startsWith(\"https://\")) u = u.substring(8)\n    else u = u.substring(7)\n    let uArr = u.split(\"/\")\n    uArr[0] = \"https://p6-novel.byteimg.com/origin\"\n    let uArr2 = []\n    uArr.forEach((x) => {\n        if (!x.includes(\"?\") && !x.includes(\"~\")) uArr2.push(x)\n        else uArr2.push(x.split(\"~\")[0])\n    })\n    u = uArr2.join(\"/\")\n    return u\n}\n\nfunction splitArray(input, size) {\n  const output = []\n  for (let i = 0; i < input.length; i += size) {\n    output.push(input.slice(i, i + size))\n  }\n  return output\n}\n\nfunction getNovelComment(book_id, type) {\n    const { java, source, book } = this\n    if (type == 0) {\n    let count = book.getVariable(\"custom\")\n    if (count && count == \"\") count = 20\n    let res = java.ajax(`https://changdunovel.com/reading/ugc/novel_comment/book/v1?query_type=0&offset=0&count=${count}&sort=create_time&need_hot_comment=0&book_id=${book_id}&aid=1967&addQueryPrefix=true`) \n    let comments = JSON.parse(res).data.comment\n    let result = `${comments.length>0?(\"(å…± \"+ comments.length +\" æ¡)\"):\"\"}\\n`\n    comments.forEach(c => {\n        let startNum = 5 - parseInt(c.score/2)\n        result += `${c.user_info.gender==1?\"ğŸ‘¨ğŸ»\":\"ğŸ‘±ğŸ»\"} ${c.user_info.user_name} || ${\"â˜…â˜…â˜…â˜…â˜…â˜…â˜†â˜†â˜†â˜†â˜†\".slice(startNum, startNum + 5)}\\n${c.text.replace(/###/,\"\")}\\n&lrm;\\n`\n    })\n    return result\n    } \n  let result = \"\"\n  return result\n}\n\nfunction getApi() {\n  return \"http://49.232.25.145:14514\"\n}",
    "lastUpdateTime": 1757820906637,
    "loginCheckJs": "if (source.getVariable()==\"\") {\n    eval(String(source.loginUrl));\n    reg(true);\n}\nresult",
    "loginUi": "[\n{\n  \"name\": \"åŸŸå\",\n  \"type\": \"text\",\n  \"action\": \"\"\n},\n{\n  \"name\": \"æ‰‹åŠ¨ç™»å½•Token\",\n  \"type\": \"password\",\n  \"action\": \"\"\n},\n\n\n{\n  \"name\": \"æ³¨å†Œè®¾å¤‡(èƒ½æ­£å¸¸ä½¿ç”¨åˆ«ç‚¹)\",\n  \"type\": \"button\",\n  \"action\": \"æ¿€æ´»è®¾å¤‡()\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 1.45\n  }\n},\n{\n  \"name\": \"æŸ¥çœ‹æ•™ç¨‹\",\n  \"type\": \"button\",\n  \"action\": \"tutorial()\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.45\n  }\n},\n\n\n{\n  \"name\": \"æŸ¥çœ‹Token\",\n  \"type\": \"button\",\n  \"action\": \"logToken()\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.45\n  }\n},\n{\n  \"name\": \"è´¦å·ç™»å½•\",\n  \"type\": \"button\",\n  \"action\": \"l2(true)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.45\n  }\n},\n{\n  \"name\": \"é€€å‡ºç™»å½•\",\n  \"type\": \"button\",\n  \"action\": \"logout()\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.45\n  }\n},\n{\n'action': \"yu()\",\n'name': 'å½“å‰æ¨¡å¼',\n'type': 'button',\n\"style\": {\n\"layout_flexGrow\": 1,\n\"layout_flexBasisPercent\": 1\n}\n},\n{\n'action': \"settype('å°è¯´æ¨¡å¼')\",\n'name': 'å°è¯´æ¨¡å¼',\n'type': 'button',\n\"style\": {\n\"layout_flexGrow\": 1,\n\"layout_flexBasisPercent\": 0.39\n}\n},\n\n{\n'action': \"settype('å¬ä¹¦æ¨¡å¼')\",\n'name': 'å¬ä¹¦æ¨¡å¼',\n'type': 'button',\n\"style\": {\n\"layout_flexGrow\": 1,\n\"layout_flexBasisPercent\": 0.39\n}\n},\n{\n'action': \"settype('æ¼«ç”»æ¨¡å¼')\",\n'name': 'æ¼«ç”»æ¨¡å¼',\n'type': 'button',\n\"style\": {\n\"layout_flexGrow\": 1,\n\"layout_flexBasisPercent\": 0.39\n}\n},\n{\n'action': \"settype('çŸ­å‰§æ¨¡å¼')\",\n'name': 'çŸ­å‰§æ¨¡å¼',\n'type': 'button',\n\"style\": {\n\"layout_flexGrow\": 1,\n\"layout_flexBasisPercent\": 0.39\n}\n},\n\n\n{\n  \"name\": \"æŸ¥è¯¢æ¨¡å¼\",\n  \"type\": \"buttonæ–‡å­—å…³é—­\",\n  \"action\": \"get()\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"é˜…è¯»æ¨¡å¼\",\n  \"type\": \"button\",\n  \"action\": \"set(0)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.45\n  }\n},\n{\n  \"name\": \"åˆ‡æ¢æ¨¡å¼\",\n  \"type\": \"button\",\n  \"action\": \"st()\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.45\n  }\n},\n{\n  \"name\": \"å¤šäººå¯¹è¯\",\n  \"type\": \"button\",\n  \"action\": \"set(1)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"çœŸäººå‘éŸ³\",\n  \"type\": \"button\",\n  \"action\": \"set(2)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"ç”œç¾å°‘å¥³\",\n  \"type\": \"button\",\n  \"action\": \"set(3)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"æ¸…äº®é’å”\",\n  \"type\": \"button\",\n  \"action\": \"set(4)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"æˆç†Ÿå¤§å”\",\n  \"type\": \"button\",\n  \"action\": \"set(5)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"å¼€æœ—é’å¹´\",\n  \"type\": \"button\",\n  \"action\": \"set(6)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"æ¸©æŸ”æ·‘å¥³\",\n  \"type\": \"button\",\n  \"action\": \"set(7)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"é£é›…é’å”\",\n  \"type\": \"button\",\n  \"action\": \"set(8)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"æ¸…çº¯å°‘å¥³\",\n  \"type\": \"button\",\n  \"action\": \"set(9)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"ç£æ€§é’å”\",\n  \"type\": \"button\",\n  \"action\": \"set(10)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"å„’é›…å¤§å”\",\n  \"type\": \"button\",\n  \"action\": \"set(11)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"ä¼˜é›…å¾¡å§\",\n  \"type\": \"button\",\n  \"action\": \"set(12)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"æ–¯æ–‡é’å”\",\n  \"type\": \"button\",\n  \"action\": \"set(13)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"çŸ¥æ€§ä¸»æ’­\",\n  \"type\": \"button\",\n  \"action\": \"set(14)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"æˆç†Ÿå‡çº§\",\n  \"type\": \"button\",\n  \"action\": \"set(15)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"å¤šäººå‡çº§\",\n  \"type\": \"button\",\n  \"action\": \"set(16)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"ä¿çš®å¾¡å§\",\n  \"type\": \"button\",\n  \"action\": \"set(17)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"åŒéŸ³çµåŠ¨\",\n  \"type\": \"button\",\n  \"action\": \"set(18)\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 0.25\n  }\n},\n{\n  \"name\": \"ç¥ä½ å¤©å¤©å¼€å¿ƒå“‡ ä¹¦æºæ¥å£by: æ¢“æ¾„qwq\",\n  \"type\": \"button\",\n  \"action\": \"t()\",\n  \"style\": {\n    \"layout_flexGrow\": 1,\n    \"layout_flexBasisPercent\": 1\n  }\n}\n]",
    "loginUrl": "\n\n\nfunction æ¿€æ´»è®¾å¤‡() {\tjava.startBrowserAwait('https://fq.xo0x.cn/api/index.php?api=device_register&action=register', \"æ¿€æ´»è®¾å¤‡\");\n}\n\n\nfunction login(){};\n\tif (source.getVariable()==\"\") {\n    \n    reg(true);\n    }\n    \nvar lists = JSON.parse(source.getVariable());\nfunction settype(Type) {\n    lists.type = Type;\n  if (Type == 'å°è¯´æ¨¡å¼') {\n        lists.module = \"3\";\n    }else\n    \n    if (Type == 'å¬ä¹¦æ¨¡å¼') {\n        lists.module = \"2\";\n    }else\n    \n    \n    if (Type == 'æ¼«ç”»æ¨¡å¼') {\n        lists.module = \"8\";\n    }else\n    \n     if (Type == 'çŸ­å‰§æ¨¡å¼') {\n        lists.module = \"11\";\n    };\n    source.setVariable(JSON.stringify(lists, null, \"\\t\"));\n    java.toast('å·²å°†ç±»å‹åˆ‡æ¢ä¸º:\\n' + Type);\n}\nyu=()=>{\nu=JSON.parse(source.getVariable()).type;\njava.toast(`\\n${u}`)\n}\n\n\n\n// ç™»å½•åŠç™»å½•æ£€æŸ¥\nfunction login_(openBrowser, checkMode) {\n    // java.removeCookie(\"snssdk.com\")\n    var cookie_ = String(cookie.getKey(\"fanqienovel.com\", \"sessionid\")) ? String(cookie.getKey(\"fanqienovel.com\", \"sessionid\")) : (source.getLoginInfoMap() ? source.getLoginInfoMap() : {})['æ‰‹åŠ¨ç™»å½•Token']\n    // java.toast(cookie_)\n    if (cookie_ && cookie_ != \"\" && !checkMode) {\n        if (!source.variableComment) {\n            java.toast(\"è¯·ä¸è¦é‡å¤ç™»å½•ï¼Œè¯·å…ˆé€€å‡ºç™»å½•ï¼\")\n        } else {\n            java.toast(\"æ‚¨ä¸ºå¡«å†™tokenç™»å½•ï¼Œè¯·æ‰‹åŠ¨ç§»é™¤tokenåå†æ¬¡ç™»å½•\")\n        }\n        return false\n    }\n    if (openBrowser) {\n        try {\n            java.startBrowserAwait(\"https://fanqienovel.com/\", \"ç™»å½•\")\n        } catch (e) {\n            java.toast(e)\n        }\n    }\n    // java.log(\"snssdk cookie: \" + java.getCookie(\"snssdk.com\") + \"will be reomved\")\n    try {\n        cookie.removeCookie(\"snssdk.com\")\n    } catch (e) {}\n    // java.log(cookie)\n    var cookie_ = \"sessionid=\" + (String(cookie.getKey(\"fanqienovel.com\", \"sessionid\")) ? String(cookie.getKey(\"fanqienovel.com\", \"sessionid\")) : (source.getLoginInfoMap())['æ‰‹åŠ¨ç™»å½•Token'])\n    let user\n    try {\n      user = JSON.parse(java.ajax(\"https://fanqienovel.com/api/user/info/v2,\" + JSON.stringify({\n        method: \"GET\",\n        headers: {\n          \"Cookie\": cookie_\n        }\n      }))).data.name\n     java.log(JSON.stringify(user))\n     } catch (e) {java.log(e)}\n    if (!cookie_ || cookie_ == \"sessionid=\" || !user) {\n        java.toast(\"æœªè·å–åˆ°ç™»å½•å‡­æ®ï¼Œç™»å½•å¤±è´¥\")\n        return false\n    }\n    java.toast(\"æ¬¢è¿ \" + user + \"\\nç™»å½•æˆåŠŸï¼\")\n    return true\n}\n\nfunction login() // ä¸€å®šç¨‹åº¦ä¸ŠåŠ ä¸Šè¿™ä¸ªå‡½æ•°èƒ½å¤Ÿæ”¯æŒæ›´å¤šçš„ç‰ˆæœ¬\n{}\n\nfunction l2(a, b) {\n  try {\n    login_(a, b)\n  } catch (e) {\n    java.log(e+\"\\n\"+e.stack)\n  }\n}\n\n// å–æ¶ˆç™»å½•\nfunction logout() {\n    cookie.removeCookie(\"fanqienovel.com\");\n    cookie.removeCookie(\"snssdk.com\");\n    if (String(cookie.getKey(\"fanqienovel.com\", \"sessionid\")) ? String(cookie.getKey(\"fanqienovel.com\", \"sessionid\")) : (source.getLoginInfoMap() ? source.getLoginInfoMap() : {})['æ‰‹åŠ¨ç™»å½•Token']) java.toast(\"è¯·æ‰‹åŠ¨ç§»é™¤å¡«å†™çš„Token\")\n    else java.toast(\"é€€å‡ºç™»å½•æˆåŠŸ\");\n}\n\nfunction logToken() {\n  java.log(\n    String(\n      cookie.getKey(\n        \"fanqienovel.com\",\n        \"sessionid\"\n      )\n    ) ? String(\n     cookie.getKey(\n        \"fanqienovel.com\", \n        \"sessionid\"\n      )\n    ) : (\n     source.getLoginInfoMap()\n      ? source.getLoginInfoMap()\n      : {}\n    )['æ‰‹åŠ¨ç™»å½•Token']\n  )\n  java.toast(\"ç™»å½•Tokenå·²æ‰“å°åˆ°æ—¥å¿—ï¼Œè¯·å¦¥å–„ä¿ç®¡\")\n}\n\nfunction tutorial() {\n  java.longToast(\"\\næ‰‹åŠ¨ç™»å½•tokenåŠŸèƒ½ç”¨äºéƒ¨åˆ†ç”¨æˆ·çš„è·¨ç«¯ç™»å½•ï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆçš„ç•™ç©ºå°±è¡Œ\\næ™®é€šç”¨æˆ·è¯·ä½¿ç”¨ä¸‹æ–¹çš„\\\"è´¦å·ç™»å½•\\\"æŒ‰é’®ç™»å½•è‡ªå·±çš„è´¦å·\")\n}\n\nfunction t() {\n  let gc = [\"(*^Ï‰^*)\", \"(=^â–½^=)\", \"(ã€‚â€™â–½â€™ã€‚)â™¡\", \"Ù©(à¹‘Â´0`à¹‘)Û¶\", \"å–µ\", \"ä½ å¥½ï¼Ÿ\", \"é€¢è€ƒå¿…è¿‡ï¼\", \"æ—©ï¾‰â˜€\"]\n  rnd = Math.floor(Math.random() * 100)\n  if (typeof gc[rnd] != \"undefined\") {\n    java.toast(gc[rnd])\n  } else {\n    let res = JSON.parse(\n      java.ajax(\"https://v1.hitokoto.cn\")\n    )\n    java.toast(res.hitokoto)\n  }\n}\n\n// éŸ³è‰²è®¾ç½®ï¼Œä»¥åŠé“¾æ¥\nvar data = [\n    [\"é˜…è¯»æ¨¡å¼\", \"\"],\n    [\"å¤šäººå¯¹è¯\", \"tone_id=51\"],\n    [\"çœŸäººå‘éŸ³\", \"tone_id=0\"],\n    [\"ç”œç¾å°‘å¥³\", \"tone_id=1\"],\n    [\"æ¸…äº®é’å”\", \"tone_id=2\"],\n    [\"æˆç†Ÿå¤§å”\", \"tone_id=4\"],\n    [\"å¼€æœ—é’å¹´\", \"tone_id=5\"],\n    [\"æ¸©æŸ”æ·‘å¥³\", \"tone_id=6\"],\n    [\"é£é›…é’å”\", \"tone_id=8\"],\n    [\"æ¸…çº¯å°‘å¥³\", \"tone_id=12\"],\n    [\"ç£æ€§é’å”\", \"tone_id=17\"],\n    [\"å„’é›…å¤§å”\", \"tone_id=29\"],\n    [\"ä¼˜é›…å¾¡å§\", \"tone_id=30\"],\n    [\"æ–¯æ–‡é’å”\", \"tone_id=31\"],\n    [\"çŸ¥æ€§ä¸»æ’­\", \"tone_id=32\"],\n    [\"æˆç†Ÿå‡çº§\", \"tone_id=74\"],\n    [\"å¤šäººå‡çº§\", \"tone_id=80\"],\n    [\"ä¿çš®å¾¡å§\", \"tone_id=100\"],\n    [\"åŒéŸ³çµåŠ¨\", \"tone_id=103\"]\n];\n\n\nvar modeNames = {3: \"å°è¯´æ¨¡å¼\",2: \"å¬ä¹¦æ¨¡å¼\",8: \"æ¼«ç”»æ¨¡å¼\",11: \"çŸ­å‰§æ¨¡å¼\"};\n\n// è®¾ç½®ä¿å­˜æ¥å£\nfunction set(num) {\n    if (num < 0 || num >= data.length) {\n        java.longToast(\"æ— æ•ˆçš„æ¥å£ç¼–å·ï¼\");\n        return;\n    }\n    var show = \"è®¾ç½®æˆåŠŸ\\nå½“å‰æ¨¡å¼ï¼š\";\n    var tips = \"\\nâ€¼ï¸è®¾ç½®å®Œæˆè¯·ç‚¹å‡»åˆ‡æ¢æ¨¡å¼â€¼ï¸\"\n    var setData = JSON.parse(source.getVariable())\n    setData.sz = num.toString();\n    setData.tone = data[num][1];\n    source.setVariable(JSON.stringify(setData, null, \" \"));\n    var msg = show + data[num][0] + tips;\n    java.longToast(msg);\n}\n\n// è®¾ç½®ä¿å­˜æ¥å£\nfunction set(num) {\n\tif (source.getVariable()==\"\") {\n    \n    reg(true);\n}\n    if (num < 0 || num >= data.length) {\n        java.longToast(\"æ— æ•ˆçš„æ¥å£ç¼–å·ï¼\");\n        return;\n    }\n    var show = \"è®¾ç½®æˆåŠŸ\\nå½“å‰æ¨¡å¼ï¼š\";\n    var tips = \"\\nâ€¼ï¸è®¾ç½®å®Œæˆè¯·ç‚¹å‡»åˆ‡æ¢æ¨¡å¼â€¼ï¸\"\n    var setData = JSON.parse(source.getVariable())\n    \n    const currentTone = data[num][1];\n    if (currentTone === \"tone_id=0\" ) {\n        setData.module = 2;\n    } else {\n        setData.module = 3;\n    }\n    \n    setData.sz = num.toString();\n    setData.tone = currentTone;\n    source.setVariable(JSON.stringify(setData, null, \"\\t\"));\n    \n    var currentMode = setData.module || 3;\n    var msg = show + (modeNames[currentMode] || \"æœªçŸ¥æ¨¡å¼\") + \n              \"\\néŸ³è‰²è®¾ç½®ï¼š\" + data[num][0] + tips;\n    java.longToast(msg);\n}\n\n\n// è·å–æ¥å£æ˜¾ç¤º\nfunction get() {\n\tif (source.getVariable()==\"\") {\n    reg(true);\n    try {\n        var v = JSON.parse(source.getVariable() || \"{}\");\n        var currentMode = v.module || 3;\n        \n        var message = \"å½“å‰æ¨¡å¼ï¼š\" + (modeNames[currentMode] || \"æœªçŸ¥æ¨¡å¼\");\n        \n        if (currentMode === 2) {\n            var sz = parseInt(v.sz || \"0\", 10);\n            var toneName = (sz >= 0 && sz < data.length) ? data[sz][0] : \"é»˜è®¤\";\n            message += \"\\néŸ³è‰²è®¾ç½®ï¼š\" + toneName;\n        }\n        \n        java.longToast(message);\n    } catch (e) {\n        java.longToast(\"è·å–æ¨¡å¼å¤±è´¥ï¼š\" + e.message);\n    }\n}else{\n    try {\n        var v = JSON.parse(source.getVariable() || \"{}\");\n        var currentMode = v.module || 3;\n        \n        var message = \"\\nå½“å‰æ¨¡å¼ï¼š\" + (modeNames[currentMode] || \"æœªçŸ¥æ¨¡å¼\");\n        \n        if (currentMode === 2 || currentMode === 3) {\n            var sz = parseInt(v.sz || \"0\", 10);\n            var toneName = (sz >= 0 && sz < data.length) ? data[sz][0] : \"é»˜è®¤\";\n            message += \"\\néŸ³è‰²è®¾ç½®ï¼š\" + toneName;\n        }\n        \n        java.longToast(message);\n    } catch (e) {\n        java.longToast(\"è·å–æ¨¡å¼å¤±è´¥ï¼š\" + e.message);\n    }}\n}\n\n    \n\nfunction st() {\n    var v = JSON.parse(source.getVariable());\n    var mode = v.module|| 3; \n\n    var newMode;\n    if (mode === 3) {\n        newMode = 2;\n    } else\n    \n     if (mode === 2) {\n        newMode = 8;\n    } else\n    \n     if (mode === 8) {\n        newMode = 11;\n    } else\n    \n    \n     if (mode === 11) {\n        newMode = 3;\n    } else {\n        newMode = 3; \n    }\n    v.module = newMode;\n\n   \n    v.sz = \"0\";\n    v.tone = \"\";\n\n    source.setVariable(JSON.stringify(v, null, \"\\t\"));\n\n    var show = \"è®¾ç½®æˆåŠŸ\\nå½“å‰æ¨¡å¼ï¼š\";\n    var tips = \"\\nè¯·å‰å¾€è¯¦æƒ…é¡µåˆ·æ–°æ˜¯å¦åˆ‡æ¢æˆåŠŸ\";\n    \n    \n    \n    var msg;\n\n    if (newMode === 3) {\n        msg = show + \"é˜…è¯»æ¨¡å¼\" + tips\n    } else if (newMode === 2) {\n    \t\n    \t   msg = show + \"å¬ä¹¦æ¨¡å¼\" + tips;\n    } else if (newMode === 8){\n    \t\n        msg = show + \"æ¼«ç”»æ¨¡å¼\" + tips;\n    } else if (newMode === 11) {\n        msg = show + \"çŸ­å‰§æ¨¡å¼\" + tips;\n    }\n    \n    java.longToast(msg);\n}\n\nfunction reg(is) {\n if (is) {\ntry {\nvar setData = {\n\t\"sz\": \"0\",\n\t\"tone\": \"\",\n\t\"st\": 1\n}\nsource.setVariable(JSON.stringify(setData, null, \"\\t\"));\n} catch (e) {\nvar setData = {\n\t\"sz\": \"0\",\n\t\"tone\": \"\",\n\t\"st\": 1\n}\nsource.setVariable(JSON.stringify(setData, null, \"\\t\"));\n    }\n  }\n}\n\n",
    "respondTime": 180000,
    "ruleBookInfo": {
      "author": "author",
      "canReName": "1",
      "coverUrl": "@js:java.getString(\"thumb_url\")",
      "init": "<js>\nvar model = [\n    [\"è‡ªåŠ¨æ¨¡å¼\", \"\"],\n    [\"å¤šäººå¯¹è¯\", \"tone_id=51\"],\n    [\"çœŸäººå‘éŸ³\", \"tone_id=0\"],\n    [\"ç”œç¾å°‘å¥³\", \"tone_id=1\"],\n    [\"æ¸…äº®é’å”\", \"tone_id=2\"],\n    [\"æˆç†Ÿå¤§å”\", \"tone_id=4\"],\n    [\"å¼€æœ—é’å¹´\", \"tone_id=5\"],\n    [\"æ¸©æŸ”æ·‘å¥³\", \"tone_id=6\"],\n    [\"é£é›…é’å”\", \"tone_id=8\"],\n    [\"æ¸…çº¯å°‘å¥³\", \"tone_id=12\"],\n    [\"ç£æ€§é’å”\", \"tone_id=17\"],\n    [\"å„’é›…å¤§å”\", \"tone_id=29\"],\n    [\"ä¼˜é›…å¾¡å§\", \"tone_id=30\"],\n    [\"æ–¯æ–‡é’å”\", \"tone_id=31\"],\n    [\"çŸ¥æ€§ä¸»æ’­\", \"tone_id=32\"],\n    [\"æˆç†Ÿå‡çº§\", \"tone_id=74\"],\n    [\"å¤šäººå‡çº§\", \"tone_id=80\"],\n    [\"ä¿çš®å¾¡å§\", \"tone_id=100\"],\n    [\"åŒéŸ³çµåŠ¨\", \"tone_id=103\"]\n];\nvar s = JSON.parse(source.getVariable())\nif (s.st == 1) { \n   book.putVariable(\"custom\", JSON.stringify(s, null, \"\\t\"));\n   s.st = 0\n   source.setVariable(JSON.stringify(s, null, \"\\t\"));\n}\n\nfunction get(index) {\n  if (index == '4') {\n    java.longToast(\"å½“å‰æ¨¡å¼ï¼šç•ªèŒ„ç•…å¬\\næœ¬ä¹¦æ”¯æŒçœŸäººå‘éŸ³\")\n  } else { \n  var v = (book.getVariable('custom') != \"\") ? book.getVariable('custom') : source.getVariable();\n    try {\n        var szStr = JSON.parse(v).sz;\n        var sz = parseInt(szStr, 10);\n        if (sz < 0 || sz >= model.length) {\n            sz = 0;\n        }\n        var show = \"å½“å‰æ¨¡å¼ï¼š\";\n        java.longToast(show + model[sz][0]);\n    } catch (e) {\n        java.longToast(\"è·å–æ¨¡å¼å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤æ¨¡å¼ã€‚\");\n    }\n  }\n}\n\nfunction getTones(tones, run) {\n    if (run == 0) {\n    var voiceTones = tones.split(',').map(function(tone) {\n        var voice = model.find(function(item) {\n            return item[1] == `tone_id=${tone}`;\n        });\n        return voice ? voice[0] : '';\n    });\n    return voiceTones.filter(Boolean) + '\\n\\u200b\\n';\n    } \n  return ''\n}\nif (!baseUrl.includes(getHost())) {\n  result = java.ajax(java.log(\n    getHost() + \n    \"/detail?book_id=\" + \n    \tbaseUrl.match(/\\d{19}/)[0]\n   ))\n}\nvar Res  = JSON.parse(result);\nvar data = Res.page || Res.data.data;\ndata = (Array.isArray(data) ? data[0] : data.book_info) || data;\nvar type = data.genre;\njava.put(\"type\",type);\nget(type);\nvar tts_info = getTones(data.tones, data.genre);\njava.put(\"tts_info\", tts_info);\nJSON.stringify(data);\n</js>",
      "intro": "&nbsp;&nbsp;\nğŸ“• æºåï¼š{{$.original_book_name}}\nğŸ“” åˆ«åï¼š{{$.book_flight_alias_name}}\nğŸ†” ç¼–å·ï¼š{{$..book_id}}\nğŸ—£ éŸ³è‰²ï¼š{{$.tones}}\nğŸ“‡ çŠ¶æ€ï¼š__status__-è¿è½½{{$.creation_status}}å®Œç»“\nâœï¸ å¼€å‘ï¼š{{$.create_time##T|\\+.*## }}\nğŸ•° æ›´æ–°ï¼š{{java.timeFormatUTC(java.getString(\"last_chapter_update_time\")*1000,'yyyy-MM-dd HH:mm:ss',8)}}\nâŒ¨ï¸ å­—æ•°ï¼š{{$.word_number}}å­—\nğŸ“ åˆ†ç±»ï¼š{{$.category##/##,}}\nğŸ·ï¸ æ ‡ç­¾ï¼šğŸ·{{$.tags##,##ğŸ·}}\nğŸ‘¤ ä¸»è§’ï¼š{{$.roles##\\[|\\\"|\\]}}\nğŸ“Š è¯„åˆ†ï¼š{{$.score}}åˆ†\nğŸ‘ï¸ åœ¨çº¿ï¼š{{$.read_count}}äººåœ¨è¯»\nğŸ”— æºç«™ï¼š{{$..source##ï¼Œ.*|æˆæƒå‘è¡Œ##}}\nğŸ¤ éŸ³è‰²ï¼š{{java.get('tts_info')}}\nğŸ“œ ç®€ä»‹ï¼š\n{{$.abstract}}\nğŸ“ ä¹¦è¯„ï¼š{{getNovelComment(java.getString(\"$.book_id\"),java.get(\"type\"))}} \nğŸ“ {{$.copyright_info##ï¼Œ.*|ä¿¡æ¯##}}\n##è¿è½½0|1å®Œç»“|ç”·ç”Ÿ0|1å¥³ç”Ÿ\n@js:result.replace(/....å+ï¼š\\n/g,\"\").replace(/....æ•°+ï¼š\\n/,\"\").replace(/....è¯„+ï¼š\\s/,\"ğŸ“ ä¹¦è¯„ï¼šæ— \").replace(/....è‰²+ï¼š\\n/,\"\").replace(/....è§’+ï¼š\\n/,\"\").replace(/....æ•°+ï¼š0å­—/,\"\").replace(\"ç”·ç”Ÿ2å¥³ç”Ÿ\",\"å‡ºç‰ˆ\").replace('__status__', (java.getString('$.book_search_visible') == 'true' ? 'æ­£å¸¸' : (java.getString('$.tomato_book_status') == '3' ? 'ä¸‹æ¶' : 'å°é»‘å±‹')))\n.replace(\"è¿è½½4å®Œç»“\",\"æ–­æ›´\")\n.replace(\"è¿è½½-1å®Œç»“\",\"æœªçŸ¥\");",
      "kind": "ç”·ç”Ÿ{{$.gender}}å¥³ç”Ÿ\n{{$.category}}\nè¿è½½{{$.creation_status}}å®Œç»“\n{{$.score}}åˆ†\n{{java.timeFormatUTC(java.getString(\"last_chapter_update_time\")*1000,'yyyy-MM-dd',8)}} \n##è¿è½½0|1å®Œç»“|ç”·ç”Ÿ0|1å¥³ç”Ÿ\n@js:result\n.replace(\"ç”·ç”Ÿ2å¥³ç”Ÿ\",\"å‡ºç‰ˆ\")\n.replace(\"è¿è½½4å®Œç»“\",\"æ–­æ›´\")\n.replace(\"è¿è½½-1å®Œç»“\",\"æœªçŸ¥\");",
      "lastChapter": "{{$.last_chapter_title}} â€¢ {{java.timeFormat(java.getString(\"last_chapter_update_time\")*1000)}}",
      "name": "book_name",
      "tocUrl": "$.book_id\n@js:\njava.put(\"id\",result);\n\"https://fanqienovel.com/api/reader/directory/detail?bookId=\"+result",
      "wordCount": "word_number"
    },
    "ruleContent": {
      "content": "<js>\nvar item_id = java.hexDecodeToString(result);\nvar book_id = java.get('book_id');\nvar type = String(java.get('type'));\njava.log(type)\nvar v = JSON.parse((book.getVariable('custom') != \"\") ? book.getVariable('custom') : source.getVariable());\nvar sz = v.sz;\nvar tone = v.tone;\n\nif (type == 1) {\n  book.type = 64;\n} else if (type == 4 || sz != 0) {\n  book.type = 32;\n} else {\n  book.type = 8;\n}\n\nif (type == 4 || sz != 0) {\n    if (type == 4) {\n    url = getHost() + `/api/index.php?api=content&ts=å¬ä¹¦&tone_id=1&item_ids=${item_id}`; \n} else if (sz != 0) {\n    url = getHost() + `/api/index.php?api=content&ts=å¬ä¹¦&${tone}&item_ids=${item_id}`; \n}\n  try {\n    result = JSON.parse(java.ajax(url)).data.content; \n  } catch(e) { result = \"è¯¥ä¹¦ä¸æ”¯æŒå½“å‰éŸ³è‰²ï¼Œè¯·æ›´æ¢å¹¶åˆ·æ–°\"; }\n} else if (type == 203) {\n  surl = getHost() + `/api/index.php?api=video&ts=çŸ­å‰§&item_id=${item_id}`; \n  param = {\"biz_param\":{\"device_level\":3,\"need_all_video_definition\":false,\"need_mp4_align\":false,\"use_os_player\":false,\"video_platform\":1024},\"video_id\": item_id} \n  head = {\n    \"body\": JSON.stringify(param),\n    \"method\": \"POST\",\n    \"headers\": {\n      \"User-Agent\": \"com.dragon.read/65532 (Linux; U; Android 13; zh_CN; PHY120; Build/TP1A.220905.001; Cronet/TTNetVersion:b2888ab3 2024-06-12 QuicVersion:1886aac1 2023-11-17)\"\n    }\n  }\n  murl = surl + JSON.stringify(head)\n  try {\nresult = JSON.parse(java.ajax(surl)).data.video_url;\nif(book.durChapterIndex == chapter.index) {\n\t\tjava.startBrowser(`data:text/html;charset=utf-8,<html><title>${chapter.title}</title><style>body {background-color: black;} video {position: fixed; top: 0; left: 0; width: 100%; height: 100%;}</style><body><video controls><source src=\"${result}\" type=\"video/mp4\"></video></body></html>`, chapter.title)\n\t\tjava.toast('æ­£åœ¨åŠ è½½è§†é¢‘\\nè§†é¢‘åŠ è½½è¾ƒæ…¢ï¼Œè¯·è€å¿ƒç­‰å¾…')\n\t }\n  result = 'ã€åˆ·æ–°æ­£æ–‡ã€‘æ’­æ”¾\\nç›´é“¾:\\n'+result\n  } catch(e) { result = 'è§†é¢‘è·å–å¤±è´¥ï¼Œå°è¯•é‡æ–°è·å–' }\n} else if (type == 1) \n{\nlet url = getHost() + '/api/index.php?api=manga&item_ids=' + item_id;\njava.log(url)\npi = JSON.parse(java.ajax(url)).data.images\nresult = pi.map(i=> `<img src=\"${i}\">`).join(\"\\n\")\n}else{\nlet url = getHost() + '/api/index.php?api=content&item_ids=' + item_id;\n java.log(url)\nlet res = JSON.parse(java.ajax(url));\n\nfunction getContent(response) {\n    if (response.success && response.data && Array.isArray(response.data) && response.data[0] && response.data[0].content) {\n        return response.data[0].content;\n    }\n    else if (response.data && response.data.content) {\n        let mat = response.data.content.match(/<article>([\\s\\S]*?)<\\/article>/); \n        try {\n            let cnt = JSON.parse(\n                mat\n                    ? mat[1].replace(/\\&/g, '\"').replace(/\\;/g, \"\").replace(/\\#34/g, \"\")\n                    : response.data.content\n            );\n            return (mat ? cnt.skeleton.data : cnt.picInfos)\n                .map((i) => {\n                    let path = mat\n                        ? cnt.materials[i.element_name].data.web_uri\n                        : \"novel-pic/\" + i.md5;\n                    return `<img src=\"https://p6-novel.byteimg.com/origin/${path}\">`;\n                })\n                .join(\"<br>\");\n        } catch (e) {\n            mat = response.data.content.match(/<body>([\\s\\S]*?)<\\/body>/) \n            return (mat ? mat[1] : response.data.content).toString()\n                .replace(/\\<\\!DOCTYPE html.*/g, \"\")\n                .replace(/\\<tt_keyword_ad.*\\<\\/tt_keyword_ad\\>/, \"\")\n                .replace(/\\<a epub.*\\>\\<\\/a\\>/g, \"\");\n        }\n    }\n    return \"æ— æ³•è¯†åˆ«çš„æ•°æ®æ ¼å¼ï¼Œé¢„è®¡åŠå°æ—¶æ¢å¤æ­£å¸¸ï¼(çœ‹åˆ°è¿™æç¤ºå°±æ„å‘³æœ‰äººåˆåœ¨ä½œæ­»ä¸‹è½½ä¹¦ç±äº†ï¼)\";\n}\n\nresult = getContent(res);\n}\nresult\n</js>"
    },
    "ruleExplore": {
      "author": "$.author",
      "bookList": "<js>\nfunction getBookIdFull(url) {\n\tconst {java} = this\n\t$ = JSON.parse(url).data\n\tif ($.book_shelf_info != 0 && $.book_shelf_info != undefined) {\n\t\tarr = $.book_shelf_info.map($ => $.book_id)\n\t} else if (list = $.data_list != 0 && $.data_list != undefined)  {\n\t\tarr = $.data_list.map($ => $.book_id_str)\n\t} else {\n\t\tjava.toast(\"è·å– book_id å¤±è´¥ï¼Œä½ å¯èƒ½éœ€è¦ç™»å½•ï¼\")\n\t}\n\treturn arr\n}\nlet ck = \"sessionid=\" + (String(cookie.getKey(\"fanqienovel.com\", \"sessionid\")) ? String(cookie.getKey(\"fanqienovel.com\", \"sessionid\")) : (source.getLoginInfoMap() ? source.getLoginInfoMap() : {})['æ‰‹åŠ¨ç™»å½•Token'])\n\ngetShelf = () => {\nlet book_shelf_url = 'https://fanqienovel.com/reading/bookapi/bookshelf/info/v:version/?aid=1967&iid=0&version_code=57700&update_version_code=57700'\nlet book_shelf_info = java.ajax(book_shelf_url + ', ' + JSON.stringify({\n  headers: {\n    'Cookie': ck\n  }\n}))\n\nbid = getBookIdFull(book_shelf_info)\nlet id_list = splitArray(bid, 100)\nlet urls = []\nid_list.forEach(i => {\n    urls.push(getApi() + \"/multi-detail?book_id=\" + i.join(\",\"))\n})\n\nres = java.ajaxAll(urls)\n\nlet resp = {book_info: []}\nres.forEach(r => {\n  resp.book_info = resp.book_info.concat(JSON.parse(r.body()).data)\n})\n\nreturn resp\n}\n\nfunction getByGroupName(name) {\n  let book_shelf_url = 'https://fanqienovel.com/reading/bookapi/bookshelf/info/v:version/?aid=1967&iid=0&version_code=57700&update_version_code=57700'\n\n  let book_shelf_info = JSON.parse(java.ajax(book_shelf_url + ', ' + JSON.stringify({\n    headers: {\n      'Cookie': ck,\n    }\n  })))\n  let group_bookids = {\n    \"æœªåˆ†ç»„\": []\n  }\n  // java.log(\n  book_shelf_info.data.book_shelf_info.forEach(i => {\n    if (!group_bookids[i.group_name ? i.group_name : \"æœªåˆ†ç»„\"]) group_bookids[i.group_name] = []\n    group_bookids[i.group_name ? i.group_name : \"æœªåˆ†ç»„\"].push(i.book_id)\n  })\n  // java.log(JSON.stringify(group_bookids[\"æœªåˆ†ç»„\"]))\n  // java.log(decodeURIComponent(name))\n  if (!group_bookids[decodeURIComponent(name)]) return {data: []}\n  //java.log(\"awa\")\n  let book_ids = splitArray(group_bookids[decodeURIComponent(name)], 100)\n  let urls = []\n\n  book_ids.forEach(i => {\n    urls.push(getApi() + \"/multi-detail?book_id=\" + i.join(\",\"))\n  })\n  java.log(urls)\n  res = java.ajaxAll(urls)\n\n  let resp = {book_info: []}\n  res.forEach(r => {\n    resp.book_info = resp.book_info.concat(JSON.parse(r.body()).data)\n  })\n\n  return resp\n}\n\nfunction getByTabIndex(index) {\n  let url = _mlsec.requestHeader(\n\t  \"bookmall/tab\",\n    \"version_name=5.8.9.32\",\n\t  null,\n\t  ck\n  )\n  let all = JSON.parse(java.ajax(url))\n  let tab = all.data.tab_item[0].cell_data[index].cell_data\n  if (!tab) tab = []\n  let bookList = []\n  for (let i of tab) {\n    bookList = bookList.concat(i.book_data)\n    // java.log(JSON.stringify(i.book_data))\n  }\n  return { book_info: bookList }\n}\n\nif (baseUrl.endsWith(\"bookshelf\")) result = getShelf(\"bookshelf/info\")\nelse if(/read_history/.test(baseUrl)) {\n  bid = getBookIdFull(result);\n  id_list = splitArray(bid, 100);\n  let urls = [];\n  id_list.forEach(i => {\nurls.push(getApi() + \"/multi-detail?book_id=\" + i.join(\",\"))\n});\n  let resp = {book_info: []}\n  urls.forEach(r => {\n    resp.book_info = resp.book_info.concat(JSON.parse(java.ajax(r)).data)\n  })\n  result = resp;\n} else {\n  let w = baseUrl.split(\"/\")\n  if (baseUrl.includes(\"groupName\")) {\n    result = getByGroupName(w[w.length - 1])\n  } else if (baseUrl.includes(\"tab\")) {\n    result = getByTabIndex(parseInt(w[w.length - 1]))\n  } else result = JSON.parse(result)\n}\nJSON.stringify({data: result.book_info || result.data.book_info || result.detail_list || result.data})\n</js>\n$.data[*]",
      "bookUrl": "{{getHost()}}/api/index.php?api=content&book_id={{$.book_id||$.series_id}}",
      "coverUrl": "@js:java.getString(\"thumb_url\")",
      "intro": "$.abstract##\\n",
      "kind": "ç”·ç”Ÿ{{$.gender}}å¥³ç”Ÿ\nè¿è½½{{$.creation_status}}å®Œç»“\n{{$.score}}åˆ†\n{{$..text}}\n{{$.sub_info}}\n##è¿è½½0|1å®Œç»“|ç”·ç”Ÿ0|1å¥³ç”Ÿ|ç”·ç”Ÿå¥³ç”Ÿ[\\s\\S]*\n@js:result\n.replace(\"ç”·ç”Ÿ2å¥³ç”Ÿ\",\"å‡ºç‰ˆ\")\n.replace(\"è¿è½½4å®Œç»“\",\"æ–­æ›´\")\n.replace(\"è¿è½½-1å®Œç»“\",\"æœªçŸ¥\");",
      "name": "$.book_name",
      "wordCount": "$.word_number"
    },
    "ruleSearch": {
      "author": "author||$..copyright",
      "bookList": "<js>\nlet list = [];\nlet book_list = [];\nlet res = JSON.parse(result);\n\ntry {\n  if (res.data.search_tabs) {\n    for (let i = 0; i < res.data.search_tabs.length; i++) {\n        let books = res[\"data\"][\"search_tabs\"][i][\"data\"];\n        if (books != null) list = list.concat(books);\n    }\n  }\n} catch (e) {}\n\nfor (let $ of list) {\n   book_list.push($.book_data ? $.book_data[0] : ($.video_data ? $.video_data[0] : $));\n}\n\nJSON.stringify(book_list)\n</js>$[*]",
      "bookUrl": "{{getHost()}}/api/index.php?api=content&book_id={{$.book_id||$.series_id}}",
      "checkKeyWord": "m:æœ«ä¸–",
      "coverUrl": "@js:java.getString(\"thumb_url||cover\")",
      "intro": "abstract||$..series_intro##\\n",
      "kind": "ç”·ç”Ÿ{{$.gender}}å¥³ç”Ÿ\nè¿è½½{{$.creation_status}}å®Œç»“\n{{$.score}}åˆ†\n{{$..text}}\n{{$.sub_info}}\n##è¿è½½0|1å®Œç»“|ç”·ç”Ÿ0|1å¥³ç”Ÿ|ç”·ç”Ÿå¥³ç”Ÿ[\\s\\S]*\n@js:result\n.replace(\"ç”·ç”Ÿ2å¥³ç”Ÿ\",\"å‡ºç‰ˆ\")\n.replace(\"è¿è½½4å®Œç»“\",\"æ–­æ›´\")\n.replace(\"è¿è½½-1å®Œç»“\",\"æœªçŸ¥\");",
      "lastChapter": "sub_title",
      "name": "book_name||$..series_title##ï¼ˆåˆ«åï¼š.*?ï¼‰",
      "wordCount": "word_number"
    },
    "ruleToc": {
      "chapterList": "<js>\nvar type = java.get('type');\nvar v = (book.getVariable('custom') != \"\") ? book.getVariable('custom') : source.getVariable();\nvar sz = JSON.parse(v).sz;\nif (type == 1) {\n  book.type = 64;\n} else if (type == 4 || sz != 0) {\n  book.type = 32;\n} else {\n  book.type = 8;\n}\nresult\n</js>$.data.chapterListWithVolume[*].[*]",
      "chapterName": "$.title",
      "chapterUrl": "$.itemId\n<js>java.base64Encode(result)</js>\ndata:;base64,{{result}},{\"type\":\"fqpyc\"}",
      "updateTime": "{{$.volume_name}} | {{java.timeFormatUTC(java.getString(\"firstPassTime\") * 1000, 'yyyy-MM-dd HH:mm:ss', 28800000)}}##ç¬¬ä¸€å·ï¼šé»˜è®¤\n@js:\nif (result.startsWith(\" |\")) result = result.slice(2)\nif (result.startsWith(\"| \")) result = result.slice(2)\nresult"
    },
    "searchUrl": "@js:\nvar r = {\n\t\"sourl\": \"https://fq.xo0x.cn\",\n\t\"type\": \"å°è¯´æ¨¡å¼\",\n\t\"module\":\"3\",\n\t\t\"sz\": \"0\",\n\t\"tone\": \"\"\n\t\n};\nif (source.getVariable()==\"\") {\n \n    source.setVariable(JSON.stringify(r, null, \"\\t\"));\n    java.toast('\\nå·²åˆå§‹åŒ–ï¼Œä½¿ç”¨é»˜è®¤ç«™æº');\n}\nmodule=JSON.parse(source.getVariable()).module;\n\n\ntab = + module\nif(tab == 3) java.put(\"i\", \"5\")\nif (String(key).startsWith(\"m:\")||String(key).startsWith(\"mï¼š\")) {\n  tab = 8\n  key = key.slice(2)\n}\nif (String(key).startsWith(\"t:\")||String(key).startsWith(\"tï¼š\")) {\n  tab = 2\n  key = key.slice(2)\n}\nif (String(key).startsWith(\"d:\")||String(key).startsWith(\"dï¼š\")) {\n  tab = 11\n  key = key.slice(2)\n}\n\nif (key.length == 19 && !Number.isNaN(parseInt(key))) {\n  result = getHost() + '/api/index.php?api=content&book_id=' + key\n} else {\nresult = getHost() + '/api/index.php?api=search&key=' + encodeURI(java.put(\"key\", key)) + '&offset=' + ((java.put(\"page\", page) - 1) * 10) + '&tab_type=' + tab\n}\nresult",
    "weight": 0
  }
]